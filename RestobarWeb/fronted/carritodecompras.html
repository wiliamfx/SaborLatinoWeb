<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras</title>
    <link rel="stylesheet" href="carrito.css">
</head>
<body>
    <h1>Carrito de Compras</h1>
    <div class="carrito-container">
        <div class="carrito-header">
            <h2>Tu Carrito</h2>
            <p>Total: S/ <span id="total-precio">0.00</span></p>
        </div>
        <div id="carrito-items">
            <!-- Los productos del carrito se agregarán aquí dinámicamente -->
        </div>
        <div class="carrito-footer">
            <button class="btn" onclick="finalizarCompra()">Finalizar Compra</button>
        </div>
    </div>

    <script>
        let carrito = JSON.parse(localStorage.getItem('carrito')) || []; // Cargar carrito desde localStorage

        // Función para renderizar los productos del carrito
        function renderCarrito() {
            const carritoContainer = document.getElementById('carrito-items');
            const totalPrecio = document.getElementById('total-precio');
            carritoContainer.innerHTML = ''; // Limpiar carrito anterior
            let total = 0;

            if (carrito.length === 0) {
                carritoContainer.innerHTML = '<p>Tu carrito está vacío.</p>';
                totalPrecio.textContent = '0.00';
                return;
            }

            carrito.forEach((producto, index) => {
                total += producto.precio * producto.cantidad;

                const item = document.createElement('div');
                item.classList.add('carrito-item');

                item.innerHTML = `
                    <div class="carrito-item-info">
                        <img src="${producto.imagen}" alt="${producto.nombre}">
                        <h3>${producto.nombre}</h3>
                        <p>Precio: S/${producto.precio}</p>
                        <p>Cantidad: 
                            <input type="number" min="1" value="${producto.cantidad}" onchange="actualizarCantidad(${index}, this.value)">
                        </p>
                    </div>
                    <button class="btn btn-remove" onclick="eliminarProducto(${index})">Eliminar</button>
                `;

                carritoContainer.appendChild(item);
            });

            totalPrecio.textContent = total.toFixed(2);
        }

        // Función para actualizar la cantidad de un producto
        function actualizarCantidad(index, nuevaCantidad) {
            nuevaCantidad = parseInt(nuevaCantidad);
            if (nuevaCantidad > 0) {
                carrito[index].cantidad = nuevaCantidad;
                localStorage.setItem('carrito', JSON.stringify(carrito)); // Guardar cambios en localStorage
                renderCarrito();
            }
        }

        // Función para eliminar un producto del carrito
        function eliminarProducto(index) {
            carrito.splice(index, 1);
            localStorage.setItem('carrito', JSON.stringify(carrito)); // Guardar cambios en localStorage
            renderCarrito();
        }

        // Función para finalizar la compra
        function finalizarCompra() {
            alert('¡Gracias por tu compra!');
            carrito = []; // Vaciar carrito
            localStorage.setItem('carrito', JSON.stringify(carrito)); // Guardar carrito vacío
            renderCarrito();
        }

        // Renderizar carrito al cargar la página
        renderCarrito();
    </script>
</body>
</html>
